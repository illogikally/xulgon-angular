<div class="user-profile">

  <div class="profile-header">
    <div class="flex-center">
      <div class="cover-avatar">
        <div class="cover">
          <img [src]="profileHeader?.profileCoverUrl">
          <div
          *ngIf="userProfile?.id == loggedInUserProfileId"
          (click)="showUpdateProfilePic('cover')"
          class="change-cover">
            <i class='bx bxs-camera'></i>
            <span>Thay ảnh bìa</span>
          </div>
        </div>
        <div  class="avatar-container flex-center">
          <div class="avatar">
            <app-photo [photo]="profileHeader?.avatar"></app-photo>
          </div>
          <div
          *ngIf="userProfile?.id == loggedInUserProfileId"
          (click)="showUpdateProfilePic('avatar')"
          class="change-avatar">
            <i class='bx bxs-camera'></i>
          </div>
        </div>
      </div>
    </div>
    <div class="flex-center">
      <h1
        class="profile-name flex-center">
        {{ profileHeader?.profileName }}
      </h1>
    </div>
  </div>
    <div 
    #actionMenu class="actions-menu-container flex-center">
      <div class="actions-menu">
        <div  *ngIf="isTabMenuSticky" class="to-top">
          <a 
          href="/{{ profileHeader?.id }}"
          (click)="scrollToTop($event)"
          class="container">
            <div class="content">
              <div class="avatar-container">
                <div class="avatar">
                  <img [src]="profileHeader?.avatar.url">
                </div>
              </div>
            
              <div class="name">
                <span>{{ userProfile?.fullName }}</span>
              </div>
            </div>
          </a>
        </div>
        <ul *ngIf="!isTabMenuSticky" class="profile-menu">
          <li
          routerLink="./"
          routerLinkActive="tab-active"
          [routerLinkActiveOptions]="{exact: true}">
            <a (click)="navigate('./', $event)">
              <div class="flex-center">
                <span>Bài viết</span>
              </div>
            </a>
          </li>
          <li
          [routerLink]="['about']"
          routerLinkActive="tab-active" >
            <a>
              <div class="flex-center">
                <span>Giới thiệu</span>
              </div>
            </a>
          </li>

          <li
            [routerLink]="['friends']"
            routerLinkActive="tab-active">
            <a (click)="navigate('friends', $event)">
              <div class="flex-center">
                <span>Bạn bè</span>
              </div>
            </a>
          </li>
          <li
            [routerLink]="['photos']"
            routerLinkActive="tab-active">
            <a (click)="navigate('photos', $event)">
              <div class="flex-center">
                <span>Ảnh</span>
              </div>
            </a>
          </li>
        </ul>

        <div class="profile-actions">
          <app-friendship-button
          [userId]="userProfile?.userId || -1"
          [friendshipStatus]="userProfile?.friendshipStatus || ''"
          [userName]="userProfile?.fullName || ''"
          ></app-friendship-button>

          <app-button
          *ngIf="userProfile?.friendshipStatus != undefined"
          (click)="openChatBox()">
            <div button>
              <i class='bx bxs-message-square-dots'></i>
              <span>Nhắn tin</span>
            </div>
          ></app-button>

          <app-button
          [hasOptions]="true"
          *ngIf="userProfile?.friendshipStatus" >
            <div button>
              <i class='bx bx-dots-horizontal-rounded'></i>
            </div>

            <div options>
              <div
              *ngIf="!userProfile.blocked"
              (click)="block()">
                <i class='bx bx-block'></i>
                <span>Chặn người này</span>
              </div>

              <div
              *ngIf="userProfile.blocked"
              (click)="unblock()" >
                <i class='bx bx-block'></i>
                <span>Gỡ chặn người này</span>
              </div>
            </div>
          </app-button>
        </div>
      </div>
    </div>
  <div class="profile-body">
    <div class="content-container">
      <router-outlet></router-outlet>
    </div>
  </div>
  <div *ngIf="pageNotFound == undefined" class="loading-page">
  </div>
</div>
<app-error-page *ngIf="pageNotFound"></app-error-page>
<app-pick-avatar
  *ngIf="isUpdateAvatar"
  (closeMe)="isUpdateAvatar = false"
></app-pick-avatar>
